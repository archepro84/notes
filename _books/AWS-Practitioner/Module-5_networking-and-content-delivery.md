# 모듈 5: 네트워킹 및 콘텐츠 전송

## 1: 네트워킹 기본 정보

### Network(네트워크)

- 네트워크는 서로 연결되어 리소스를 공유하는 2개 이상의 클라이언트 시스템
- 네트워크는 서브넷으로 논리적으로 분할할 수 있다.
- 네트워킹에서 모든 클라이언트를 서로 연결하고 클라이언트 간에 통신하려면 네트워킹 디바이스(ex: 라우터 또는 스위치)가 필요

## 2: Amazon VPC

### Amazon Virtual Private Cloud(VPC)

- AWS 리소스를 실행할 수 있는 **논리적으로 격리된 영역**을 프로비저닝 할 수 있다.
- 가상 네트워킹 리소스를 제어할 수 있다.
    - IP 주소 범위 선택
    - 서브넷 생성
    - 라우팅 테이블 및 네트워크 게이트웨이 구성
- 네트워크 구성을 손쉽게 사용자 지정할 수 있다.
- 다단계 보안을 사용할 수 있도록 지원
- **다른 VPC와 논리적으로 격리**됨
- **사용자의 AWS 계정 전용**
- 단일 AWS 리전에 속하며 **여러 가용 영역에 걸쳐 구현될 수 있음**

### 서브넷

- **VPC를 분할하는 IP 주소의 범위**
- 단일 가용 영역(AZ)에 속함
- Public 또는 Private으로 분류된다.

### IP 주소 지정

- **VPC를 생성한 후에는 주소 범위를 변경할 수 없음**
- 가장 큰 IPv4 CIDR: /16
- 가장 작은 IPv4 CIDR: /28
- IPv6도 지원
- 서브넷의 CIDR 블록은 **중첩될 수 없음**

### 예약된 IP 주소

### 퍼블릭 IP 주소 유형

- 퍼블릭
    - **탄력적 IP 주소**를 통해 **수동**으로 할당
    - 서브넷 수준에서 퍼블릭 IP 주소 **자동 할당 설정**을 통해 자동으로 할당
- 탄력적
    - **AWS 계정과 연결**됨
    - 언제든지 할당 및 재매핑 가능
    - 추가 요금이 적용될 수 있음

### 탄력적 네트워크 인터페이스

- 가상 네트워크 인터페이스
    - 인스턴스에 연결
    - 인스턴스에서 분리하고 다른 인스턴스에 연결하여 네트워크 트래픽을 리다이렉션
- 새 인스턴스에 다시 연결될 때 속성이 그대로 적용
- VPC의 각 인스턴스마다 기본 네트워크 인터페이스가 있어서 VPC의 IPv4 주소 범위에 속하는 프라이빗 IPv4 주소가 이 인터페이스에 할당된다.

### 라우팅 테이블 및 경로

- 라우팅 테이블에는 서브넷에서 네트워크 트래픽을 보내도록 구성할 수 있는 규칙 (또는 경로) 세트가 포함되어 있다.
- 각 경로는 대상 위치와 대상을 지정한다.
- 각 서브넷은 라우팅 테이블(최대 1개)과 연결되어야 한다.
- **VPC를 최초 생성할 때, 기본으로 생성**된다.

### 정리

- VPC는 AWS 클라우드의 논리적으로 격리된 섹션
- VPC는 한 리전에 속하며 CIDR 블록을 필요로 한다.
- VPC는 서브넷으로 다시 나뉜다.
- 서브넷은 하나의 가용 영역에 속하며 CIDR 블록을 필요로 한다.
- 라우팅 테이블은 **서브넷의 트래픽을 제어**한다.
- 라우팅 테이블에는 기본 로컬 경로가 있다.
- 사용자가 테이블에 경로를 추가한다.
- 로컬 경로는 삭제할 수 없다.

## 3: VPC 네트워킹

### 인터넷 게이트웨이 (Internet Gateway)

- 확장 가능하며 이중화를 지원하는 고가용성 VPC 구성요소
- VPC의 인스턴스와 인터넷 간 통신이 가능한 이유

### NAT(Network Address Translation) 게이트웨이

- **프라이빗 서브넷의 인스턴스를 인터넷 또는 기타 AWS 서비스에 연결**
- 인터넷에서 해당 인스턴스와 연결을 시작하지 못하게 할 수 있다.
- NAT 게이트웨이 대신 VPC의 퍼블릭 서브넷에 NAT 인스턴스를 사용할 수 있다.
- NAT 게이트웨이는 더 나은 가용성과 향상된 대역폭을 제공하면서도 관리 작업은 간소화 하는 관리형 NAT 서비스

### VPC 공유

- VPC 공유를 통해 AWS Organizations의 **동일한 조직 내의 다른 AWS 계정과 서브넷 공유 가능**
- 업무 분리
- 소유권
- 보안 그룹
- 효율성
- 하드 제한 사항 없음
- 비용 최적화

### VPC 피어링

- **두 VPC 사이**에서 비공개적으로 **트래픽을 라우팅**할 수 있게 하는 **두 VPC 사이의 네트워킹 연결**
- 라우팅 테이블에서 대상 위치를 VPC B의 IP 주소로 설정하고 대상을 피어링 리소스 ID로 설정한다.
- 제한 사항
    - IP 주소 범위는 중첩될 수 없다.
    - 전이적 피어링은 지원되지 않는다. → 3개의 VPC가 있을 때, A → B, A → C일 때, B는 묵시적으로 C에 연결되지 않는다.
    - **동일한 2개의 VPC간에는 하나의 피어링 리소스만 설정 가능**

### AWS Direct Connect

- 네트워크와 DX 로케이션 중 하나 간에 **전용 프라이빗 네트워크 연결**을 설정할 수 있다.
- **온프레미스와 AWS 리소스 간의** 네트워크 트래픽을 전송할 수 있다.
- 네트워크 비용을 줄이고, 대역폭 처리량을 높이며, 인터넷 기반 연결보다 **더 일관된 네트워크 환경을 제공**

### VPC 엔드포인트

- AWS PrivateLink에서 제공하는 AWS 서비스 및 VPC 엔드포인트 서비스에 **비공개로 연결할 수 있는 가상 디바이스**
- 유형
    - 인터페이스 VPC 엔드포인트
        - AWS PrivateLink로 구동되는 서비스에 연결을 지원
    - 게이트웨이 엔드포인트

### AWS Transit Gateway

- 다양한 연결 옵션 및 게이트웨이를 활용할 수 있다.
- Direct Connect, NAT Gateway, Internet Gateway, VPC 피어링 등이 포함
- **여러 AWS 계정 및 리전에 분산된 수백 개의 VPC를 보유한 AWS 고객에게 유용**
- VPC 피어링은 VPC 페어를 연결할 수 있지만, 지점 간 연결 정책을 중앙에서 관리하는 기능 없이, 여러 VPC 지점간에 연결하여 관리하는것은 운영비용이 많이들기 때문에 해당 서비스를 도입한다면 유용하다.
- 중앙 게이트웨이와 네트워크 전반의 각 VPC, 온프레미스 데이터 센터 또는 원격 사무실 간의 **단일 연결만 생성하여 관리**하면 된다.

### 정리

- VPC 네트워킹 옵션
    - 인터넷 게이트 웨이
    - NAT Gateway
    - VPC Endpoint
    - VPC 피어링
    - VPC 공유
    - AWS 사이트 간 VPN
    - AWS Direct Connect
    - AWS Transit Gateway
- VPC 마법사를 사용하여 설계를 구현할 수 있다.

## 4: VPC 보안

### 보안그룹 (Security Group)

- 가상 방화벽 역할을 하며 인스턴스에 대한 인바운드 및 아웃바운드 트래픽을 제어한다.
- **인스턴스 수준**에서 작동한다.
- 기본 보안 그룹은 모든 인바운드 트래픽을 거부하고 모든 아웃바운드 트래픽을 허용한다.
- **상태를 저장한다.** -> **Stateful 하다.**
- **허용 규칙은 지정**할 수 있지만, **거부 규칙은 지정할 수 없다.**
- **모든 규칙은 트래픽 허용을 결정하기 전**에 평가된다.

### Network ACL(네트워크 액세스 제어 목록, Access Control List)

- **서브넷 수준**에서 작동한다.
- VPC의 선택적 보안 계층으로 하나 이상의 서브넷에서 송수신되는 트래픽을 제어하기 위한 **방화벽 역할**을 한다.
- 별개의 인바운드 및 아웃바운드 규칙이 있으며, 각 규칙은 트래픽을 **허용하거나 거부**할 수 있다.
- 기본 네트워크 ACL은 인바운드 및 아웃바운드 IPv4 트래픽을 모두 허용한다.
- **상태를 저장하지 않는다.** -> **Stateless 하다.**
- **사용자 지정 ACL은 규칙을 추가하기 전까지** 모든 인바운드 및 아웃바운드 트래픽을 거절한다.
- 모든 규칙은 **번호가 가장 낮은 규칙부터 번호순으로 평가**된다.

### 정리

- VPC 아키텍처에 보안을 구축한다.
    - 가능하면 서브넷을 격리한다.
    - 필요에 따라 적절한 게이트웨이 디바이스 또는 VPN 연결을 선택한다.
    - 방화벽을 사용한다.
- 보안 그룹 및 네트워크 ACL은 VPC를 보호하는 데 사용할 수 있는 방화벽 옵션이다.

## 5: Amazon Route 53

### Amazon Route 53

- 가용성과 확장성이 우수한 DNS(Domain Name System) 웹 서비스
- www.amazon.com과 같은 이름을 컴퓨터가 서로 연결하는 데 사용하는 숫자 IP 주소(ex: 192.168.0.1)로 변환하여 최종 사용자를 인터넷 어플리케이션으로 라우팅하는데 사용됨
- 도메인 이름을 등록할 수 있도록 지원
- 리소스의 상태를 확인하는 데 사용
- 트래픽 흐름을 나타냄

### AWS Route 53 지원 라우팅

- 단순 라우팅
    - 단일 서버 환경에서 사용
- 가중치 라운드 로빈 라우팅
    - 리소스 레코드 세트에 가중치를 할당하여 빈도 지정
- 지연 시간 라우팅
    - 글로벌 어플리케이션의 성능 향상 지원
- 지리적 위치 라우팅
    - 사용자의 위치에 따라 트래픽 라우팅
- 지리 근접 라우팅
    - 리소스의 위치에 따라 트래픽 라우팅
- 장애 조치 라우팅
    - 기본 사이트에 접속할 수 없는 경우 백업 사이트로 장애 조치
- 다중 응답 라우팅
    - 무작위로 선택된 최대 8개의 정상 레코드로 DNS 쿼리에 응답

### 정리

- Amazon Route 53은 도메인 이름을 숫자 IP 주소로 변환하는 클라우드 DNS 웹 서비스로, **가용성과 확장성**이 뛰어나다.
- Amazon Route 53는 **다양한 유형의 라우팅 정책을 지원**한다.
- **다중 리전 배포**는 전 세계 사용자를 위한 어플리케이션 성능을 높인다.
- Amazon Route 53 장애 조치 기능을 이용하여 어플리케이션의 가용성을 개선할 수 있다.

## 6: Amazon CloudFront

### CDN(콘텐츠 전송 네트워크, Content Delivery Network)

- 전 세계에 분산된 캐싱 서버 시스템
- **자주 요청되는 파일(정적 콘텐츠)의 사본을 캐싱**
- 가까운 캐시 엣지 또는 PoP(Point of Presence)에서 요청된 콘텐츠의 **로컬 사본 전송**
- **동적 컨텐츠 전송 가속화**
- **어플리케이션 성능 및 확장성 개선**

### Amazon CloudFront

- 빠르고 안전한 글로벌 CDN 서비스
- **엣지 로케이션** 및 리전 엣지 캐시의 글로벌 네트워크
- 셀프 서비스 모델
- 종량 과금제

### 엣지 로케이션

- CloudFront가 고객에게 인기 있는 콘텐츠를 신속하게 제공하기 위해 사용하는 **데이터 센터의 네트워크**

### 리전 엣지 캐시

- 엣지 로케이션에 상주하기에는 **사용 빈도가 낮은 콘텐츠를 캐싱**하는 CloudFront 로케이션
- 오리진 서버와 글로벌 엣지 로케이션 사이에 위치한다.

### Amazon CloudFront의 이점

- 빠른 속도와 글로벌한 규모
- 엣지 보안
- 고도로 프로그래밍 가능
- AWS와 완벽하게 통합
- 비용 효율성

### Amazon CloudFront 요금

- 데이터 송신
- Http(s) 요청 건수에 대해 요금 부과
- 무효화 요청
- 전용 IP 사용자 지정 SSL

### 정리

- CDN은 콘텐츠 전송을 가속화하는 전 세계에 분산된 캐싱 서버 시스템
- Amazon CloudFront는 짧은 지연 시간과 빠른 전송 속도로 글로벌 인프라를 통해 데이터, 동영상, 어플리케이션 및 API를 안전하게 전송하는 속도가 빠른 CDN 서비스이다.