# 모듈 7: 스토리지

## 1: Amazon Elastic Block Store (Amazon EBS)

### Amazon EBS

- Amazon EC2 인스턴스에 사용할 수 있는 **영구 블록 스토리지 볼륨**
- 디바이스 전원이 차단된 후 데이터를 보관하는 데이터 스토리지 디바이스
- **비휘발성 스토리지**

### 블록 스토리지, 객체 스토리지

- 1GB 파일에서 글자를 변경하려 할 때,
    - 블록 스토리지 (Block Storage)
        - 해당 글자가 포함된 블록 하나(파일 일부)를 변경
    - 객체 스토리지 (Object Storage)
        - 전체 파일을 업데이트

### Amazon EBS 용도

- Amazon EC2 인스턴스용 부팅 볼륨 및 스토리지
- 파일 시스템의 데이터 스토리지
- 데이터베이스 호스트
- 엔터프라이즈 어플리케이션

### Amazon EBS 기능

- 스냅샷
- 암호화
- 탄력성

### 볼륨, IOPS, 요금

- 볼륨
    - EBS 볼륨은 **인스턴스에 독립적**으로 유지
    - 월별 프로비저닝한 요량을 기준으로 요금 부과
- IOPS
    - 범용 SSD
        - 스토리지가 해제될 때 까지 월별 프로비저닝한 용량(GB)을 기준으로 요금 부과
    - 마그네틱
        - 볼륨에 대한 요청 수를 기준으로 요금 부과
    - 프로비저닝된 IOPS SSD
        - IOPS로 프로비저닝한 용량(해당 달에 프로비저닝한 일수의 백분율을 곱한 값)을 기준으로 요금이 부과
- 스냅샷
    - S3에 EBS 스냅샷을 추가하는 비용은 저장되는 월별 GB 단위의 데이터
- 데이터 전송
    - **인바운드 데이터 전송은 무료**
    - **리전 간 아웃바운드 데이터 전송에는 요금이 발생**

### 정리

- EBS 기능
    - EC2용 영구적이고 사용자 지정 가능한 블록 스토리지
    - HDD 및 SSD 유형
    - 동일한 가용 영역에 복제된
    - 쉽고 명료한 암호화
    - 탄력적 볼륨
    - 스냅샷을 사용하여 백업

## 2: Amazon Simple Storage Service (Amazon S3)

### Amazon Simple Storage Service

- 객체 수준 스토리지, 파일 일부를 변경하려면, 파일을 변경한 다음 변경된 파일 전체를 업로드 해야함.
- 버킷이라는 리소스 내에 객체로 저장
- 사실상 무제한의 스토리지
    - 단일 객체는 5TB로 제한됨
- 버킷 및 객체에 대한 세분화된 액세스

### 스토리지 클래스

- Amazon S3 Standard
    - 자주 액세스하는 데이터를 위해 내구성, 가용성 및 성능이 뛰어는 객체 스토리지를 제공
- Amazon S3 Intelligent-Tiering
    - 성능 영향 또는 운영 오버헤드 없이 가장 비용 효과적
    - 객체의 액세스 패턴을 모니터링하고 연속 30일 동안 액세스하지 않은 객체를 빈번하지 않은 액세스 계층으로 이동
    - 빈번하지 않은 액세스 계층의 객체에 액세스하면 이 객체는 자동으로 빈번한 액세스 계층으로 이동
    - 수명이 길고 액세스 패턴을 알 수 없거나 예측할 수 없는 데이터에 적합
- Amazon S3 Standard-Infrequent Access (Amazon S3 Standard-IA)
    - 액세스 빈도가 낮지만 필요할 때 빠르게 액세스해야 하는 데이터에 필요
    - 장기 스토리지, 백업 및 재해 복구 파일용 데이터 스토어에 적합
- Amazon S3 One Zone-Infrequent Access(Amazon S3 One Zone-IA)
    - 액세스 빈도가 낮지만 필요할 때 빠르게 액세스 해야하는 데이터에 적합
    - 1개의 단일 가용 영역에 데이터를 저장하므로 Standart-IA 보다 저렴
    - 온프레미스 데이터 또는 쉽게 다시 생성할 수 있는 데이터의 보조 백업 복사본을 저장
- Amazon S3 Glacier
    - 데이터 아카이빙을 위한 안전하고 내구력이 있으며 저렴한 스토리지 클래스
    - 수명 주기 정책을 사용하여 모든 S3 스토리지 클래스와 Glacier 간에 데이터 전송 가능
- Amazon S3 Glacier Deep Archive
    - 일 년에 한두 번 액세스되는 데이터의 장기 보존 및 디지털 보존을 지원
    - 규제 준수 요구 사항을 충족하기 위해 7~10년 데이터 세트를 보존하는 고객을 위해 설계
    - 지리적으로 분산된 3개 이상의 가용 영역에 걸쳐 복제 및 저장되며, 12시간 이내에 복원 가능

### Amazon S3의 장점

- 데이터가 리전에 중복으로 저장됨
- 원활한 확장을 고려한 설계
- 어디서나 데이터에 액세스
- 일반 사용 사례
    - 어플리케이션 자산 저장
    - 정적 웹 호스팅
    - 백업 및 DR (재해 복구)
    - 빅 데이터를 위한 스테이징 영역

### Amazon S3 요금

- 사용한 만큼 지블
    - 월별 GB
    - 다른 리전으로 송신
    - PUT, COPY, POST, LIST 및 GET 요청
    - 데이터 수신은 무료
- 비용을 지불하지 않음
    - Amazon S3로 수신
    - Amazon S3에서 같은 리전의 Amazon CloudFront 또는 EC2로 송신
    - 전송된 데이터에 대해서는 요금이 발생

### 정리

- Amazon S3는 완전 관리형 클라우드 스토리지 서비스
- 객체를 사실상 무제한으로 저장할 수 있다.
- 사용한 만큼만 요금을 지불
- 언제든 URL을 통해 Amazon S3에 액세스할 수 있음
- Amazon S3는 풍부한 보안 제어 기능을 제공

## 3: Amazon Elastic File System (Amazon EFS)

### Amazon Elastic File System

- AWS 서비스 및 온프레미스 리소스와 함께 사용할 수 있는 탄력적인 파일 스토리지 제공
- 어플리케이션을 중단하지 않고 필요에 따라 동적으로 확장 가능
- 파일을 추가하고 제거하면 자동으로 확장 및 축소
- AWS 클라우드 파일 스토리지
- 페타바이트 규모의 지연 시간이 짧은 파일 시스템
- 공유 스토리지, 탄력적 용량
- EC2용 Linux 기반 AMI와 호환

### Amazon EFS 구현

1. EC2 리소스를 생성하고 인스턴스 시작
2. EFS 파일 시스템을 생성
3. 적절한 서브넷에 탑재 대상을 생성
4. EC2 인스턴스를 탑재 대상에 연결
5. AWS 계정의 리소스 및 보호 상태를 확인

### Amazon EFS 리소스

- 파일 시스템
    - 탑재 대상
        - 서브넷 ID
        - 보안 그룹
        - 파일 시스템당 하나 이상
        - VPC 서브넷에서 생성
        - 가용 영역당 하나
        - 동일한 VPC에 있어야 함
    - 태그
        - Key-Value Pair

### 정리

- EFS는 네트워크를 통해 파일 스토리지를 제공
- 빅 데이터 및 분석, 미디어 처리 워크플로, 콘텐츠 관리, 웹 서비스 및 홈 디렉터리에 이상적
- 스토리지 관리 작업을 없애주는 완전 관리형 서비스
- 콘솔, API 또는 CLI에서 액세스할 수 있음
- 파일이 추가 또는 제거될 때 확장하거나 축소할 수 있으며 사용한만큼만 지불

## 4: Amazon S3 Glacier

### Amazon S3 Glacier

- 데이터 아카이빙 및 장기 백업을 위한 안전하고 안정적이며 비용이 매우 저렴한 클라우드 스토리지 서비스
- Amazon S3 Glacier에 Amazon S3 콘텐츠의 수명 주기 아카이빙을 구성할 수 있음
- 단일 파일의 크기는 최대 40TB 지원

### Amazon S3 Glacier 용어

- 아카이브(Archive) → 파일
    - Amazon S3 Glacier에 저장하는 사진, 동영상, 파일 또는 문서와 같은 객체
    - 스토리지의 기본단위
    - 각 아카이브에는 고유한 ID가 있으며 설명도 있을 수 있음
- 볼트(Vault) → 버킷
    - 아카이브를 저장하기 위한 컨테이너
    - 볼트를 생성할 때는 볼트 이름과 볼트가 위치할 리전을 지정
- 볼트 액세스 정책(Vault Access Policy) → 버킷 액세스 정책
    - 볼트에 저장된 데이터에 액세스할 수 있는 사용자와 없는 사용자, 수행할 수 있는 작업 또는 없는 작업 정의
    - 각 볼트에 대해 하나의 볼트 액세스 권한 정책을 생성하여 볼트에 대한 액세스 권한 관리
    - 볼트 잠금 정책 사용 가능

### Amazon Glacier 검색 옵션

- 신속
    - 검색은 보통 1~5분 이내로 완료 (가장 높은 비용)
- 표준
    - 검색은 보통 3~5시간 이내로 완료 (신속 검색보다 길고 대량 검색보다 짧은 시간)
- 대량
    - 검색은 보통 5~12시간 이내로 완료 (가장 낮은 비용

### Amazon S3 Glacier 사용 사례

- 미디어 자산 아카이빙
- 의료 정보 아카이빙
- 규제 및 규정 준수를 위한 아카이빙
- 과학 데이터 아카이빙
- 디지털 보존
- 마그네틱 테이프 대체

### Amazon S3 Glacier 사용

- Restful 웹 서비스
- Java, .NET SDK
- 수명 주기 정책을 사용하는 Amazon S3
    - 수명 주기 정책을 사용하면 생성 후 기간을 기준으로 객체를 삭제 또는 이동 가능

### Amazon S3 Glacier를 사용한 보안

- IAM으로 액세스 제어
- Amazon S3 Glacier는 AES-256을 사용하여 데이터 암호화
- Amazon S3 Glacier가 자동으로 키 관리

### 정리

- Amazon S3 Glacier는 보안, 내구성 및 매우 저렴한 비용을 제공
- Amazon S3 Glacier 요금은 리전을 기준으로 함
- 매우 저렴한 비용의 설계는 장기 아카이브에 적합